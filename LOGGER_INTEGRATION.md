# TORM æ—¥å¿—ç³»ç»Ÿé›†æˆæŒ‡å—

## æ¦‚è¿°

TORM ç°åœ¨å®Œå…¨é›†æˆäº†å†…ç½®çš„ `@logger/` åŒ…ï¼Œæ›¿æ¢äº†ä¹‹å‰ä½¿ç”¨çš„ `fmt.Printf` è¾“å‡ºã€‚æ‰€æœ‰çš„æ—¥å¿—è¾“å‡ºç°åœ¨éƒ½ä½¿ç”¨ç»Ÿä¸€çš„æ—¥å¿—ç³»ç»Ÿï¼Œæ”¯æŒä¸åŒçš„æ—¥å¿—çº§åˆ«å’Œç»“æ„åŒ–æ—¥å¿—ã€‚

## ä¸»è¦ç‰¹æ€§

### ğŸ¯ ç»Ÿä¸€çš„æ—¥å¿—æ¥å£
- æ‰€æœ‰ç»„ä»¶ä½¿ç”¨åŒä¸€ä¸ªæ—¥å¿—ç³»ç»Ÿ
- æ”¯æŒç»“æ„åŒ–æ—¥å¿—è®°å½•
- é»˜è®¤æ—¥å¿—çº§åˆ«ä¸º `INFO`
- æ”¯æŒåŠ¨æ€è°ƒæ•´æ—¥å¿—çº§åˆ«

### ğŸ“Š æ—¥å¿—çº§åˆ«
```go
logger.DEBUG   // è°ƒè¯•ä¿¡æ¯ - å¼€å‘ç¯å¢ƒä½¿ç”¨
logger.INFO    // ä¸€èˆ¬ä¿¡æ¯ - é»˜è®¤çº§åˆ«  
logger.WARN    // è­¦å‘Šä¿¡æ¯
logger.ERROR   // é”™è¯¯ä¿¡æ¯
logger.FATAL   // è‡´å‘½é”™è¯¯
```

### ğŸ”§ é›†æˆç»„ä»¶
- **BaseModel**: æ¯ä¸ªæ¨¡å‹å®ä¾‹éƒ½æœ‰ç‹¬ç«‹çš„æ—¥å¿—è®°å½•å™¨
- **æŸ¥è¯¢æ„é€ å™¨**: SQL æŸ¥è¯¢å’Œæ‰§è¡Œä¿¡æ¯
- **æ•°æ®åº“è¿ç§»**: è¡¨ç»“æ„å˜æ›´æ—¥å¿—
- **æ•°æ®åº“ç®¡ç†å™¨**: è¿æ¥å’Œäº‹åŠ¡ç®¡ç†æ—¥å¿—

## ä½¿ç”¨æ–¹æ³•

### 1. åŸºæœ¬ä½¿ç”¨

```go
// åˆ›å»ºæ¨¡å‹æ—¶ä¼šè‡ªåŠ¨é›†æˆæ—¥å¿—ç³»ç»Ÿ
user := model.NewAutoMigrateModel(&User{})

// è·å–æ¨¡å‹çš„æ—¥å¿—è®°å½•å™¨
logger := user.GetLogger()

// è®°å½•ä¸åŒçº§åˆ«çš„æ—¥å¿—
logger.Debug("è°ƒè¯•ä¿¡æ¯", "user_id", 1)
logger.Info("æ“ä½œä¿¡æ¯", "action", "create")
logger.Warn("è­¦å‘Šä¿¡æ¯", "message", "æ€§èƒ½è¾ƒæ…¢") 
logger.Error("é”™è¯¯ä¿¡æ¯", "error", err)
```

### 2. è®¾ç½®æ—¥å¿—çº§åˆ«

```go
// ä¸ºå•ä¸ªæ¨¡å‹è®¾ç½®æ—¥å¿—çº§åˆ«
user.SetLogLevel(logger.DEBUG)  // å¼€å‘ç¯å¢ƒ
user.SetLogLevel(logger.INFO)   // ç”Ÿäº§ç¯å¢ƒï¼ˆé»˜è®¤ï¼‰

// å…¨å±€è®¾ç½®æ—¥å¿—çº§åˆ«
logger.SetDefaultLevel(logger.WARN)
```

### 3. è‡ªå®šä¹‰æ—¥å¿—è®°å½•å™¨

```go
// åˆ›å»ºè‡ªå®šä¹‰æ—¥å¿—è®°å½•å™¨
customLogger := logger.NewLogger(logger.DEBUG)

// åº”ç”¨åˆ°æ¨¡å‹
user.SetLogger(customLogger)

// æ–‡ä»¶æ—¥å¿—è®°å½•å™¨
fileLogger, err := logger.NewFileLogger(logger.INFO, "app.log")
if err == nil {
    user.SetLogger(fileLogger)
}
```

### 4. ç»“æ„åŒ–æ—¥å¿—

```go
// ä½¿ç”¨é”®å€¼å¯¹è®°å½•ç»“æ„åŒ–æ—¥å¿—
user.GetLogger().Info("ç”¨æˆ·æ“ä½œ",
    "user_id", 123,
    "action", "login", 
    "ip", "192.168.1.1",
    "timestamp", time.Now())

// è¾“å‡ºæ ¼å¼: 
// 2024-01-15 10:30:45 [INFO] ç”¨æˆ·æ“ä½œ {user_id:123 action:login ip:192.168.1.1 timestamp:2024-01-15 10:30:45}
```

## è‡ªåŠ¨æ—¥å¿—è®°å½•

### SQL æŸ¥è¯¢æ—¥å¿—
```go
// æ‰§è¡ŒæŸ¥è¯¢æ—¶è‡ªåŠ¨è®°å½• SQL å’Œæ‰§è¡Œæ—¶é—´
users, err := user.Where("age", ">", 18).Get()
// è‡ªåŠ¨è¾“å‡º: [INFO] æ‰§è¡ŒSQLè¯­å¥ {sql:SELECT * FROM users WHERE age > ? args:[18]}
```

### æ•°æ®åº“è¿ç§»æ—¥å¿—
```go
// AutoMigrate æ—¶è‡ªåŠ¨è®°å½•è¿ç§»ä¿¡æ¯
err := user.AutoMigrate()
// è‡ªåŠ¨è¾“å‡º: 
// [INFO] è¡¨ç»“æ„æ›´æ–°æˆåŠŸ {changes:3}
// [INFO] è¡¨ç»“æ„å˜æ›´ {column:name action:ä¿®æ”¹ details:length changed from 50 to 100}
```

### æ¨¡å‹æ“ä½œæ—¥å¿—
```go
// ä¿å­˜æ¨¡å‹æ—¶çš„æ—¥å¿—
err := user.Save()
// å¦‚æœå¼€å¯ DEBUG çº§åˆ«ï¼Œä¼šè®°å½•è¯¦ç»†çš„æ“ä½œä¿¡æ¯
```

## é…ç½®ç¤ºä¾‹

### å¼€å‘ç¯å¢ƒé…ç½®
```go
func setupDevelopmentLogging() {
    // å¯ç”¨è¯¦ç»†çš„è°ƒè¯•æ—¥å¿—
    logger.SetDefaultLevel(logger.DEBUG)
    
    // æˆ–è€…ä½¿ç”¨å¿«é€Ÿé…ç½®
    db.QuickEnableDebugLogging() // åŒ…å« SQL æŸ¥è¯¢æ—¥å¿—
}
```

### ç”Ÿäº§ç¯å¢ƒé…ç½®
```go
func setupProductionLogging() {
    // åªè®°å½•é‡è¦ä¿¡æ¯
    logger.SetDefaultLevel(logger.INFO)
    
    // ä½¿ç”¨æ–‡ä»¶æ—¥å¿—
    err := db.SetupFileLogging("app.log", "info", true)
    if err != nil {
        log.Fatal("è®¾ç½®æ–‡ä»¶æ—¥å¿—å¤±è´¥:", err)
    }
}
```

### æµ‹è¯•ç¯å¢ƒé…ç½®
```go
func setupTestLogging() {
    // æµ‹è¯•æ—¶åªè®°å½•é”™è¯¯
    logger.SetDefaultLevel(logger.ERROR)
    
    // æˆ–è€…å®Œå…¨ç¦ç”¨æ—¥å¿—
    db.QuickDisableLogging()
}
```

## æ€§èƒ½è€ƒè™‘

### æ—¥å¿—çº§åˆ«æ§åˆ¶
```go
// åªæœ‰å½“å‰æ—¥å¿—çº§åˆ«å…è®¸æ—¶æ‰ä¼šå¤„ç†æ—¥å¿—
// DEBUG çº§åˆ«çš„æ—¥å¿—åœ¨ INFO çº§åˆ«ä¸‹ä¸ä¼šè¢«å¤„ç†ï¼Œé¿å…æ€§èƒ½å¼€é”€

if logger.GetLevel() <= logger.DEBUG {
    // åªåœ¨éœ€è¦æ—¶æ‰è¿›è¡Œå¤æ‚çš„æ—¥å¿—æ•°æ®å‡†å¤‡
    complexData := prepareComplexLogData()
    logger.Debug("è¯¦ç»†è°ƒè¯•ä¿¡æ¯", "data", complexData)
}
```

### é¿å…é¢‘ç¹çš„å­—ç¬¦ä¸²æ ¼å¼åŒ–
```go
// æ¨è: ä½¿ç”¨ç»“æ„åŒ–æ—¥å¿—
logger.Info("ç”¨æˆ·ç™»å½•", "user_id", userID, "ip", clientIP)

// é¿å…: æ‰‹åŠ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²  
logger.Info(fmt.Sprintf("ç”¨æˆ· %d ä» %s ç™»å½•", userID, clientIP))
```

## è¿ç§»æŒ‡å—

å¦‚æœä½ ä¹‹å‰ä½¿ç”¨äº† `fmt.Printf` è¿›è¡Œæ—¥å¿—è¾“å‡ºï¼Œç°åœ¨å¯ä»¥è¿™æ ·è¿ç§»ï¼š

### ä¹‹å‰
```go
fmt.Printf("æ‰§è¡ŒSQL: %s, å‚æ•°: %v\n", sql, args)
fmt.Printf("âš ï¸ è­¦å‘Š: %s\n", message)  
fmt.Printf("âœ… æ“ä½œæˆåŠŸ: %s\n", result)
```

### ç°åœ¨
```go
logger.Info("æ‰§è¡ŒSQL", "sql", sql, "args", args)
logger.Warn("è­¦å‘Š", "message", message)
logger.Info("æ“ä½œæˆåŠŸ", "result", result)
```

## æœ€ä½³å®è·µ

1. **ä½¿ç”¨åˆé€‚çš„æ—¥å¿—çº§åˆ«**
   - `DEBUG`: è¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯ï¼Œä»…å¼€å‘ç¯å¢ƒ
   - `INFO`: é‡è¦çš„ä¸šåŠ¡æ“ä½œï¼Œç”Ÿäº§ç¯å¢ƒé»˜è®¤çº§åˆ«
   - `WARN`: éœ€è¦æ³¨æ„ä½†ä¸å½±å“åŠŸèƒ½çš„é—®é¢˜
   - `ERROR`: é”™è¯¯å’Œå¼‚å¸¸æƒ…å†µ

2. **ä½¿ç”¨ç»“æ„åŒ–æ—¥å¿—**
   - ä½¿ç”¨é”®å€¼å¯¹è€Œä¸æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²
   - ä¿æŒé”®åä¸€è‡´æ€§ï¼Œä¾¿äºæ—¥å¿—åˆ†æ

3. **é¿å…æ•æ„Ÿä¿¡æ¯**
   - ä¸è¦è®°å½•å¯†ç ã€å¯†é’¥ç­‰æ•æ„Ÿä¿¡æ¯
   - å¯¹ç”¨æˆ·éšç§æ•°æ®è¿›è¡Œè„±æ•å¤„ç†

4. **åˆç†çš„æ—¥å¿—é‡**
   - å¼€å‘ç¯å¢ƒå¯ä»¥è¯¦ç»†è®°å½•
   - ç”Ÿäº§ç¯å¢ƒæ§åˆ¶æ—¥å¿—é‡ï¼Œé¿å…å½±å“æ€§èƒ½

## æ€»ç»“

ç°åœ¨ TORM æ‹¥æœ‰äº†å®Œæ•´çš„æ—¥å¿—ç³»ç»Ÿé›†æˆï¼š

- âœ… **ç»Ÿä¸€æ¥å£**: æ‰€æœ‰ç»„ä»¶ä½¿ç”¨åŒä¸€æ—¥å¿—ç³»ç»Ÿ
- âœ… **é»˜è®¤ INFO çº§åˆ«**: é€‚åˆç”Ÿäº§ç¯å¢ƒçš„é»˜è®¤é…ç½®  
- âœ… **ç»“æ„åŒ–æ—¥å¿—**: ä¾¿äºåˆ†æå’Œç›‘æ§
- âœ… **æ€§èƒ½ä¼˜åŒ–**: æ™ºèƒ½çš„æ—¥å¿—çº§åˆ«æ§åˆ¶
- âœ… **æ˜“äºé…ç½®**: ç®€å•çš„ API å’Œå¿«é€Ÿé…ç½®æ–¹æ³•
- âœ… **ä¸­æ–‡æ”¯æŒ**: æ‰€æœ‰æ—¥å¿—æ¶ˆæ¯éƒ½æ˜¯ä¸­æ–‡

é€šè¿‡è¿™ä¸ªé›†æˆï¼Œä½ å¯ä»¥æ›´å¥½åœ°ç›‘æ§å’Œè°ƒè¯•ä½ çš„ TORM åº”ç”¨ç¨‹åºã€‚
